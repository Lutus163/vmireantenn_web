<!doctype html>
<html lang="ru">
<head>
    {% block meta %}{% endblock %}
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="static/styles.css">
    <link rel="stylesheet" href="static/chatbot.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="static/chatbot.js"></script>
    <script src="static/fp2.js"></script>
    <!-- <script async src="https://script.click-chat.ru/chat.js?wid=259dd434-6a86-49d1-944f-5ed095ae3f36"></script> -->
    <script src="//code.jivo.ru/widget/jaVAJljmv6" async></script>
    <script src="//code.jivo.ru/widget/rFnPlHFhDF" async></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.4/jquery.inputmask.bundle.min.js"></script>
    <script async src="https://telegram.org/js/telegram-widget.js?22" data-telegram-login="vmireantenn_bot" data-size="medium" data-auth-url="https://vmireantenn.cloudpub.ru/login" data-request-access="write"></script>
    {% block title %}{% endblock %}

</head>
<body>
<div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
  <h5 class="my-0 mr-md-auto font-weight-normal">В мире антенн</h5>
  <nav class="my-2 my-md-0 mr-md-3">
    <a class="p-2 text-dark" href="/">Главная</a>
    <a class="p-2 text-dark" href="/about">Про магазин</a>
    {% if current_user.is_authenticated %}
    <a class="p-2 text-dark" href="/cart"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cart4" viewBox="0 0 16 16">
      <path d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5M3.14 5l.5 2H5V5zM6 5v2h2V5zm3 0v2h2V5zm3 0v2h1.36l.5-2zm1.11 3H12v2h.61zM11 8H9v2h2zM8 8H6v2h2zM5 8H3.89l.5 2H5zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0m9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0"/>
    </svg> Корзина </a>
    {% endif %}
    {% block nav %} {% endblock %}


  </nav>
  <!-- {% if request.path == '/profile' %} <a class="btn btn-outline-primary" href="/ban">BAN</a> {% endif %} -->



<div class="btn-group">
  {% if not current_user.is_authenticated %}
    <a class="btn btn-outline-primary mt-1 mr-2 rounded-pill" href="/register">Регистрация</a>
  {% endif %}

  <br>

  {% if current_user.is_authenticated and not request.path == '/profile' %}
    <a class="btn btn-outline-primary mt-1 mr-2 rounded-pill" href="/profile">Личный кабинет</a>
  {% endif %}

  {% if not current_user.is_authenticated and not request.path == '/profile' %}
    <a class="btn btn-outline-primary mt-1 mr-2 rounded-pill" href="/login">Вход</a>
  {% endif %}

  {% if current_user.is_authenticated and not request.path == '/profile' %}
    <a class="btn btn-outline-primary mt-1 mr-2 rounded-pill" href="/logout">Выход</a>
  {% endif %}
</div>



</div>

{% block body %} {% endblock %}

  <footer class="pt-4 my-md-5 pt-md-5 border-top">
    <div class="row">
      <div class="col-12 col-md">
        <a href="/" class="col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
          <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"></use></svg>
        </a>
        <small class="d-block mb-3 text-muted">© 2017-2024</small>
      </div>
      <div class="col-6 col-md">
        <h5>Features</h5>
        <ul class="list-unstyled text-small">
          <li><a class="text-muted" href="#">Cool stuff</a></li>
          <li><a class="text-muted" href="#">Random feature</a></li>
          <li><a class="text-muted" href="#">Team feature</a></li>
          <li><a class="text-muted" href="#">Stuff for developers</a></li>
          <li><a class="text-muted" href="#">Another one</a></li>
          <li><a class="text-muted" href="#">Last time</a></li>
        </ul>
      </div>
      <div class="col-6 col-md">
        <h5>Resources</h5>
        <ul class="list-unstyled text-small">
          <li><a class="text-muted" href="#">Resource</a></li>
          <li><a class="text-muted" href="#">Resource name</a></li>
          <li><a class="text-muted" href="#">Another resource</a></li>
          <li><a class="text-muted" href="#">Final resource</a></li>
        </ul>
      </div>
      <div class="col-6 col-md">
        <h5>About</h5>
        <ul class="list-unstyled text-small">
          <li><a class="text-muted" href="#">Team</a></li>
          <li><a class="text-muted" href="#">Locations</a></li>
          <li><a class="text-muted" href="#">Privacy</a></li>
          <li><a class="text-muted" href="#">Terms</a></li>
        </ul>
      </div>
    </div>
  </footer>

<!-- chatbot__btn
 <div class="chatbot__btn">
  <div class="chatbot__tooltip d-none">Есть вопрос?</div>
</div> -->
<script>
  // конфигурация чат-бота
  const configChatbot = {};
  // CSS-селектор кнопки, посредством которой будем вызывать окно диалога с чат-ботом
  configChatbot.btn = '.chatbot__btn';
  // ключ для хранения отпечатка браузера
  configChatbot.key = 'fingerprint';
  // реплики чат-бота
  configChatbot.replicas = {
    bot: {
      0: { content: ['Привет!', 'Я Инфинити - бот поддержки сайта <a href="/" target="_blank">Shop</a>'], human: [0, 1, 2] },
      1: { content: 'Я тоже рад, как мне к Вам обращаться?', human: [3] },
      2: { content: 'Как мне к Вам обращаться?', human: [3] },
      3: { content: '{{name}}, что Вас интересует?', human: [4, 5] },
      4: { content: '{{name}}, для этого перейдите на <a href="/" target="_blank">эту страницу</a>. Она содержит подробную инструкцию по использованию этого чат-бота.', human: [6] },
      5: { content: "{{name}}, какой у Вас вопрос?", human: [7] },
      6: { content: '{{name}}, мы получили Ваш вопрос! Скажите, как с Вами удобнее будет связаться?', human: [8, 9] },
      7: { content: '{{name}}, укажите пожалуйста ваш телефон', human: [10] },
      8: { content: '{{name}}, укажите пожалуйста ваш Email ниже', human: [10] },
      9: { content: 'Готово! {{name}}, мы свяжемся с вами в ближайшее время по {{contact}}. Всего хорошего!', human: [6] },
    },
    human: {
      0: { content: 'Привет! Я рад с тобой познакомиться', bot: 1 },
      1: { content: 'Салют!', bot: 2 },
      2: { content: 'Приветик, Инфинити!', bot: 2 },
      3: { content: '', bot: 3, name: 'name' },
      4: { content: 'Меня интересует, как я могу использовать этот чат-бот у себя на сайте', bot: 4 },
      5: { content: 'Хочу оставить запрос разработчику чат-бота', bot: 5 },
      6: { content: 'В начало', bot: 3 },
      7: { content: '', bot: 6, name: '' },
      8: { content: 'по телефону', bot: 7 },
      9: { content: 'по email', bot: 8 },
      10: { content: '', bot: 9, name: 'contact' },
    }
  }
  // корневой элемент
  configChatbot.root = SimpleChatbot.createTemplate();
  // URL chatbot.php
  configChatbot.url = '/api';
  // создание SimpleChatbot
  let chatbot = new SimpleChatbot(configChatbot);
  // при клике по кнопке configChatbot.btn
  document.querySelector(configChatbot.btn).onclick = function (e) {
    this.classList.add('d-none');
    const $tooltip = this.querySelector('.chatbot__tooltip');
    if ($tooltip) {
      $tooltip.classList.add('d-none');
    }
    configChatbot.root.classList.toggle('chatbot_hidden');
    chatbot.init();
  };

  // добавление ключа для хранения отпечатка браузера в LocalStorage
  let fingerprint = localStorage.getItem(configChatbot.key);
  if (!fingerprint) {
    Fingerprint2.get(function (components) {
      fingerprint = Fingerprint2.x64hash128(components.map(function (pair) {
        return pair.value
      }).join(), 31)
      localStorage.setItem(configChatbot.key, fingerprint)
    });
  }

  // подсказка для кнопки
  const $btn = document.querySelector(configChatbot.btn);
  $btn.addEventListener('mouseover', function (e) {
    const $tooltip = $btn.querySelector('.chatbot__tooltip');
    if (!$tooltip.classList.contains('chatbot__tooltip_show')) {
      $tooltip.classList.remove('d-none');
      setTimeout(function () {
        $tooltip.classList.add('chatbot__tooltip_show');
      }, 0);
    }
  });
  $btn.addEventListener('mouseout', function (e) {
    const $tooltip = $btn.querySelector('.chatbot__tooltip');
    if ($tooltip.classList.contains('chatbot__tooltip_show')) {
      $tooltip.classList.remove('chatbot__tooltip_show');
      setTimeout(function () {
        $tooltip.classList.add('d-none');
      }, 200);
    }
  });

  setTimeout(function () {
    const tooltip = document.querySelector('.chatbot__tooltip');
    tooltip.classList.add('chatbot__tooltip_show');
    setTimeout(function () {
      tooltip.classList.remove('chatbot__tooltip_show');
    }, 10000)
  }, 10000);
</script>
</body>
</html>